\documentclass[]{report}
\usepackage{a4wide}
\usepackage{amsmath}


% Title Page
\title{PDEs assignment}
\author{Robin Evers}


\begin{document}
\maketitle
\begin{itemize}
	\item[1.] Draw the characteristics for the following equations and write the general solution.
	\begin{align}
		u_t + 7u_x &= 0\\
		u_t - 2u_x + 3u &= 0.
	\end{align}
	\item[Sol.] To find characteristics, we solve the ODE
	\begin{align*}
		x'(t)&=7\\
		x(0)&=x_0.
	\end{align*} 
	This gives us the characteristic curves $x(t)$ defined by 
	\[x(t)=x_0+7t.\]
	On these curves we have
	\begin{align*}
	\frac{d}{dt}u(x(t),t)&=(u(x(t),t))_t+(x(t))_t(u(x(t)),t)_x\\
	&=(u(x(t),t))_t+7(u(x(t)),t)_x\\
	&=0.
	\end{align*}
	This means that solutions $u(x(t),t)$ to (1) are constant on these characteristic curves $x(t)$, hence the general solution to (1) is given by
	\[u(x(t),t)=u(x_0,0)=u(x(t)-7t,0).\]
	\item[Sol.] To find characteristics, we solve the ODE
	\begin{align*}
	x'(t)&=-2\\
	x(0)&=x_0.
	\end{align*} 
	This gives us the characteristic curves $x(t)$ defined by 
	\[x(t)=x_0-2t.\]
	On these curves we have
	\begin{align*}
	\frac{d}{dt}u(x(t),t)&=(u(x(t),t))_t+(x(t))_t(u(x(t)),t)_x\\
	&=(u(x(t),t))_t-2(u(x(t)),t)_x\\
	&=-3u(x(t),t).
	\end{align*}
	Hence
	\[\frac{d}{dt}u(x(t),t)+3u(x(t),t)=0.\]
	This gives us the ODE
	\begin{align*}
		u_t+3u&=0\\
		u(x(0),0)&=u_0(x_0).
	\end{align*} 
	We multiply the ODE by $e^{3t}$ to get
	\[\frac{d}{dt}ue^{3t}=u_te^{3t}+3ue^{3t}=0.\]
	This means that $ue^{3t}$ is constant on $x(t)$, so
	\[e^{3t}u(x(t),t)=e^0u(x(0),0)=u_0(x_0)\]
	hence the general solution to (2) is given by
	\[u(x(t),t)=e^{-3t}u_0(x_0)=e^{-3t}u_0(x(t)+2t).\]
	\item[2.] Let $g$ be the gravitational constant and $h : \mathbf{R} \times \mathbf{R}^{+}$ be the height of a fluid, define $\phi = gh$. Further, let $v : \mathbf{R} \times \mathbf{R}^{+}$ be the horizontal velocity. The shallow water equations are
	given by
	\begin{equation}
	\begin{split}
		\phi_t +(v\phi)_x &= 0\\
		v_t + \left(\frac{v^2}{2}+\phi\right)_x&=0.
	\end{split}
	\end{equation}
	Let $\eta = \eta(\phi, v)$ be an entropy for the shallow water equations. Prove that it must satisfy
	\begin{equation}
		\frac{\partial^2\eta}{\partial v^2} = \phi \frac{\partial^2\eta}{\partial\phi^2}.
	\end{equation}
	\item[Sol.] We start by rewriting the shallow water equations as in (4) to one vectorial equation
	\[\partial_t\vec{u}+\partial_x \vec{f}(\vec{u})=0\]
	where $\vec{u}=(\phi,v)$ and $\vec{f}=(v\phi,\frac{v^2}{2}+\phi)$. The Jacobian of $f$ is given by
	\begin{align*}
		D\vec{f}=\begin{pmatrix}
		\frac{\partial f_1}{\partial \phi}	& \frac{\partial f_1}{\partial v}\\
		\frac{\partial f_2}{\partial \phi}	& \frac{\partial f_2}{\partial v}\end{pmatrix}
		=\begin{pmatrix}
		v	& \phi\\
		1	& v
		\end{pmatrix}.
	\end{align*}
	Let $\eta = \eta(\phi, v)$ be an entropy for the shallow water equations, the matrix of second derivatives of $\eta$ is given by
	\begin{align*}
	D^2\eta=\begin{pmatrix}
	\frac{\partial^2 \eta}{\partial \phi^2}	& \frac{\partial^2 \eta}{\partial \phi \partial v}\\
	\frac{\partial^2 \eta}{\partial v \partial \phi}	& \frac{\partial^2  \eta}{\partial v^2}\end{pmatrix}.
	\end{align*}
	Since $\eta$ is an entropy for the shallow water equations, we have
	\[(D\vec{f})^T D^2\eta = D^2 \eta D\vec{f}.\]
	This gives us four equations, the equation given by the second row, first column is
	\[\phi \frac{\partial^2 \eta}{\partial \phi^2}	+ v  \frac{\partial^2 \eta}{\partial v \partial \phi} =  v  \frac{\partial^2 \eta}{\partial v \partial \phi} + \frac{\partial^2 \eta}{\partial v^2}.\]
	By subtracting $v  \frac{\partial^2 \eta}{\partial v \partial \phi}$ from both sides we find the requested equality for our entropy $\eta$
	\newpage
	\item[3.]The Barotropic compressible Euler equations are given when the internal energy
	of the system is constant. The equations are given by conservation of mass and momentum
	\begin{equation}
	\begin{split}
		\rho_t +(\rho v)_x &= 0\\
		(\rho v)_t + \left(\rho v^2 + p\right)_x &= 0,
	\end{split}
	\end{equation}
	with $p = p(\rho)$ for a smooth function $p$. Assume $p'(\rho)>0$ then show that
	\begin{equation}
	\eta(\rho,\rho v)= \frac12 \rho v^2 + P(\rho)
	\end{equation}
	is an entropy when $P''(\rho) = \frac{p'(\rho)}{\rho}$ for $\rho >0$. What is the associated entropy flux?
	\item[Sol.]We start by rewriting the Euler equations as in (5) to one vectorial equation
	\[\partial_t\vec{u}+\partial_x \vec{f}(\vec{u})=0\]
	where $\vec{u}=(\rho, \rho v)$ and $\vec{f}(y,z)=(z,\frac{z^2}{y}+p(y))$. 
	The Jacobian of $f$ is given by
	\begin{align*}
	D\vec{f}=\begin{pmatrix}
	\frac{\partial f_1}{\partial y}	& \frac{\partial f_1}{\partial z}\\
	\frac{\partial f_2}{\partial y}	& \frac{\partial f_2}{\partial z}\end{pmatrix}
	=\begin{pmatrix}
	0	& 1\\
	p'(y) - (\frac{z}{y})^2	& \frac{2z}{y}
	\end{pmatrix}.
	\end{align*}
	We write $\eta$ as a function of variables $y, z$ as $\eta(y,z)=\frac{z^2}{2y}+P(y)$. The Jacobian of $\eta$ is given by
	\begin{align*}
	D\eta=\begin{pmatrix}
	\frac{\eta}{\partial y}	,& \frac{\partial \eta}{\partial z}\end{pmatrix}
	=\begin{pmatrix}
	\frac{-z^2}{2y^2} + P'(y)	,& \frac{z}{y}
	\end{pmatrix}.
	\end{align*}
	A pair $(\eta,q)$ is an entropy/entropy flux pair associated with (5) if $Dq=D\eta D\vec{f}$.
	If $\eta$ as defined in (6) is an entropy, we find that the entropy flux $q$ must satisfy
	\begin{align*}
			Dq=D\eta D\vec{f}&=\begin{pmatrix}
			\frac{-z^2}{2y^2} + P'(y)	,& \frac{z}{y}
			\end{pmatrix} \begin{pmatrix}
		0	& 1\\
		p'(y) - (\frac{z}{y})^2	& \frac{2z}{y}
		\end{pmatrix}\\
		&=\begin{pmatrix}
		\frac{zp'(y)}{y} - (\frac{z}{y})^3	,& \frac{3z^2}{2y^2}+P'(y).
		\end{pmatrix}\\
	\end{align*}
	Hence the partial derivative of $q$ to $z$ has to be
	\[\frac{\partial q}{\partial z} = \frac{3z^2}{2y^2}+P'(y) = \frac{3}{2y^2} z^2 + P'(y),\]
	which means $q$ has to be of the form
	\[q=\frac{1}{2y^2}z^3+P'(y)z + C(y).\]
	where $C$ is independent of $z$. We derive this to $y$ to find
	\[\frac{\partial q}{\partial y} = -\left(\frac{z}{y}\right)^3 + P''(y)z + C'(y). \]
	This equals the expression we found for $Dq$ if $P''(y) = \frac{p'(y)}{y}$ and $C'(y)=0$. Therefore $\eta(\rho, \rho v)$ is an entropy when $P''(\rho) = \frac{p'(\rho)}{\rho}$ for $\rho>0$, the associated entropy flux is given by 
	\[q=\frac{(\rho v)^3}{2\rho^2}+P'(\rho)\rho v + C = \frac{\rho v^3}{2} + P'(\rho)\rho v + C,\]
	where $C$ is independent of $\rho$ and $v$.
	\newpage
	\item[4.]
	Consider the following partial differential equation (PDE)
	\begin{equation}
	u_t + u_{xxx} + 6uu_x = 0, u = u(x, t)
	\end{equation}
	known as the Korteweg-de Vries equation (or KdV) and which describes water waves in shallow waters.
	\begin{itemize}
		\item[(a)] Consider a scaling transformation, on both the independent and dependent
		variables, of the form
		\begin{equation}
		S : (t, x, u) \mapsto (T, X, U) = (at, bx, cu)
		\end{equation}
		where $a, b$ and $c$ are nonzero constants. Find conditions for the parameters $a, b$ and $c$
		such that the transformation $S$ is a symmetry transformation of the KdV equation. Use the obtained symmetry to deduce that if $u = f(x, t)$ is a solution of the KdV equation then $u = \epsilon^2f(\epsilon x, \epsilon^3 t)$ is also a solution for all nonzero $\epsilon$.
		\item[Sol.] The PDE given in (6) admits the symmetry if, given a solution $u = f(x, t)$, the transformed function \[\tilde{u} = \tilde{f}(\tilde{x},\tilde{t})=cf(bx,at)\] 
		is also a solution of the same PDE, i.e.
		\begin{equation}
			\tilde{u}_{\tilde{t}} + \tilde{u}_{\tilde{x}\tilde{x}\tilde{x}} + 6\tilde{u}\tilde{u}_{\tilde{x}} = 0.
		\end{equation}
		To find $a,b,c$ for which this is true, we first calculate the transformed derivatives
		\[\frac{\partial}{\partial\tilde{t}}\tilde{u}(\tilde{x},\tilde{u})=\frac{dt}{d\tilde{t}}\frac{\partial}{\partial t}cu(x,t)=\frac{c}{a}\frac{\partial}{\partial t} u(x,t),\]
		
		\[\frac{\partial}{\partial\tilde{x}}\tilde{u}(\tilde{x},\tilde{u})=\frac{dx}{d\tilde{x}}\frac{\partial}{\partial x}cu(x,t)=\frac{c}{b}\frac{\partial}{\partial x} u(x,t),\]
		and similarly
		\[\frac{\partial^2}{\partial\tilde{x}^2}\tilde{u}(\tilde{x},\tilde{t})=\frac{c}{b^2}\frac{\partial^2}{\partial x}u(x,t),\]
		\[\frac{\partial^3}{\partial\tilde{x}^2}\tilde{u}(\tilde{x},\tilde{t})=\frac{c}{b^3}\frac{\partial^3}{\partial x}u(x,t).\]
		Hence, if we substitute to the left hand side of (9) we obtain
		\[\frac{c}{a}\frac{\partial}{\partial t} u(x,t)+\frac{c}{b^3}\frac{\partial^3}{\partial x}u(x,t) + \frac{6c^2}{b}u(x,t)\frac{\partial}{\partial x} u(x,t)=0\]
		when
		\[\frac{c}{a}=\frac{c}{b^3}=\frac{c^2}{b}.\]
		Since we assume $a,b,c$ nonnegative, this holds when $a=b^3$ and $c=\frac{1}{b^2}$. Let us fix $b=\epsilon$ for any nonnegative $\epsilon$, then 
		\[\tilde{u}(\tilde{x},\tilde{t}) = \epsilon^2f(\epsilon x, \epsilon^3)\]
		is also a solution to (7). 
		\item[(b)] Consider solutions of the KdV equation of the special form
		\begin{equation}
			u(x,t)=f(\xi), \ \ \  \xi(x,t)=x-vt
		\end{equation}
		where $v$ is a real constant and substitute it in (10). Such type of solutions are known as travelling wave solutions. Use the chain rule for partial derivatives to obtain an ordinary differential equation (ODE) for $f(\xi)$. It should look like
		\begin{equation}
			-vf(\xi)+3f(\xi)^2 +f''(\xi)-A=0 
		\end{equation}
		Can you solve the obtained differential equation?
		\item[Sol.]  We are looking for solutions to
		\[(f(\xi))_t + (f(\xi))_{xxx}+6f(\xi)(f(\xi))_x=0.\]
		Note that $\xi_x=1$ and $\xi_t=-v$, therefore we can use the chain rule to obtain
		\begin{align*}
			0= (f(\xi))_t + (f(\xi))_{xxx}+6f(\xi)(f(\xi))_x &= -vf'(\xi)+(f'(\xi))_{xx}+6f(\xi)(f'(\xi))\\
			&=-vf'(\xi)+(f''(\xi))_x+6f(\xi)(f'(\xi))\\
			&=-vf'(\xi)+f'''(\xi)+6f(\xi)(f'(\xi))
		\end{align*}
		integrating over $\xi$ now gives the following ODE for $f(\xi)$
		\begin{align*}
			-vf(\xi)+f''(\xi)+3f(\xi)^2+A = 0
		\end{align*}
		for some constant $A$.
		Multiplying this by $f'(\xi)$ gives
		\[-vf(\xi)f'(\xi)+f''(\xi)f'(\xi)+3ff'(\xi)(\xi)^2+Af'(\xi) = 0.\]
		We now integrate over $\xi$ again to obtain
		\[\frac{-v}{2}f(\xi)^2 + \frac12 (f'(\xi))^2+f(\xi)^3+f(\xi)A+B=0\]
		for some constant $B$. 
		We introduce the variable $y$ and make a substitution of variables, $y(\xi)=\frac{-1}2f(\xi)+\frac{v}{12}$. Now $y'(\xi)=\frac{-1}{2}f'(\xi)$ and thus
		\begin{align*}
			(y'(\xi))^2 = \left(\frac12 f'(\xi)\right)^2 = \frac14 \left( f'(\xi)\right)^2 &=\frac{v}{4} f(\xi)^2-\frac12 f(\xi)^3-\frac12f(\xi)A-\frac12B.
		\end{align*}
		Hence
		\begin{align*}
			2(y'(\xi))^2 - \frac{v}{2}\left( -2y(\xi)+\frac{v}{6}\right) ^2+\left(- 2y(\xi)+\frac{v}{6}\right) ^3 +(-2y(\xi)+\frac{v}{6})A+B=0.
		\end{align*}
		We rewrite this to
		\begin{align*}
				0&= 2(y'(\xi))^2 -\frac{v}{2}\left( 4y(\xi)^2-\frac{2v}{3}y(\xi)+\frac{v^2}{36}\right) -8y(\xi)^3+
				\frac{4v}{3}y(\xi)^2-\frac{v^2}{18}y(\xi)+\frac{2v}{3}y(\xi)^2-\frac{v^2}{9}y(\xi)\\
				&\hspace{9cm}+\frac{v^3}{216}-2y(\xi)A + \frac{v}{6} A + B\\
				&=2(y'(\xi))^2 + y(\xi)^2 \left( -2v+\frac{4v}{3} + \frac{2v}{3}\right) + y(\xi)\left( \frac{v^2}{3}-\frac{v^2}{18}-\frac{v^2}{9}-2A\right) - 8 y(\xi)^3 -\frac{v^3}{72} + \frac{v^3}{216}\\
				&\hspace{12cm}  + \frac{vA}{6} +B\\
				&=2(y'(\xi))^2  + y(\xi)\left(\frac{v^2}{6} - 2A \right) - 8 y(\xi)^3 -\frac{v^3}{108} + \frac{vA}{6} +B.
		\end{align*}
		Dividing by 2 gives us 
		\[y'(\xi)^2 = 4y(\xi)^3+ g_2 y(\xi) +g_3\]
		where
		\[g_2 = A-\frac{v^2}{12}, \ \ \ \ g_3= \frac{v^3}{216}-\frac{vA}{12}-\frac{B}{2}.\]
		We can solve for $\xi$ as this is the differential equation satisfied by Weierstrassâ€™s $\wp$-function. Substituting back into $f(\xi)=-2y(\xi)+\frac{v}{6}$ solves the differential equation.
		\item[c.] Apply the symmetry argument of part (a) to the travelling wave form (10) to deduce that higher amplitude waves travel faster. This is a purely nonlinear effect, can you explain this? This shows that even when an exact solution cannot be found, we can still find properties of the solutions by studying the symmetries of the equation.
		\item[Sol.] To obtain a higher amplitude wave the parameter $\epsilon$ in our transformation becomes larger. For $\epsilon>1$, the wave speed, which is given by $\epsilon^2v$, thus becomes smaller when $v<0$ and greater when $v>0$. Therefore the waves must travel faster when we have higher amplitude. 
		
		This is purely nonlinear as in linear theory, we would assume the wave amplitudes to be sufficiently small to ignore contributions of nonlinear terms, (i.e. terms of second order and higher) in wave amplitude. In the linear case it therefore suffices to consider only one Fourier component at a time, which leads to the ability of expressing the general solutions by an appropriate superposition of Fourier components. 
		
		When wave amplitudes become larger, linear theory would predict exponential growth of unstable waves, but nonlinear effects cause saturation and limit the wave amplitude at a finite level and therefore the ability to find properties of the solutions when exact solutions cannot be found.
		\item[d.] Verify that the quantities
		\begin{equation}
			x^2u, \text{ and } x^3t^{-1}
		\end{equation}
		are invariant under the symmetry obtained in part (a). Deduce that the general form of those solutions of the KdV equation which are invariant under the scaling symmetry is
		\begin{equation}
			u(x, t) = \frac{1}{x^2}f(\xi), \ \ \ \ \xi(x, t) = x^3t^{-1}. 
		\end{equation}
		Using again the chain rule obtain an ODE for $f(\xi)$. Try to find simple special solutions for the obtained ODE and then find the corresponding solutions for the KdV equation. For example, start with the assumption that $f(\xi)$ is a constant function. Can you find a rational solution $f(\xi)$?
		\item[Sol.]
	\end{itemize}
	

\end{itemize}

\end{document}          
